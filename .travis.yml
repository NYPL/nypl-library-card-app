language: node_js
node_js:
  - "10"
cache:
  directories:
    - node_modules
install: npm install
script: npm test
before_deploy: echo 'All unit tests passed;
  Preparing to deploy Get a Library Card to AWS'
deploy:
  - provider: elasticbeanstalk
    skip_cleanup: true
    access_key_id: "$AWS_ACCESS_KEY_ID_PRODUCTION"
    secret_access_key: "$AWS_SECRET_ACCESS_KEY_PRODUCTION"
    region: us-east-1
    app: nypl-library-card-app
    env: nypl-library-card-app-production-2
    bucket_name: elasticbeanstalk-us-east-1-946183545209
    bucket_path: nypl-library-card-app-production
    on:
      repo: NYPL/nypl-library-card-app
      branch: production
  - provider: elasticbeanstalk
    skip_cleanup: true
    access_key_id: "$AWS_ACCESS_KEY_ID_PRODUCTION"
    secret_access_key: "$AWS_SECRET_ACCESS_KEY_PRODUCTION"
    region: us-east-1
    app: nypl-library-card-app
    env: nypl-library-card-app-qa-18
    bucket_name: elasticbeanstalk-us-east-1-946183545209
    bucket_path: nypl-library-card-app-qa
    on:
      repo: NYPL/nypl-library-card-app
      branch: qa
# Disabling development deploy for cost savings
# - provider: elasticbeanstalk
#  skip_cleanup: true
#  access_key_id: "$AWS_ACCESS_KEY_ID_DEVELOPMENT"
#  secret_access_key: "$AWS_SECRET_ACCESS_KEY_DEVELOPMENT"
#  region: us-east-1
#  app: nypl-library-card-app
#  env: nypl-library-card-app-development
#  bucket_name: elasticbeanstalk-us-east-1-224280085904
#  bucket_path: nypl-library-card-app-development
#  on:
#    repo: NYPL/nypl-library-card-app
#    branch: main
after_deploy:
  echo 'Successfully executed deploy trigger for Get a Library Card on
  AWS'
env:
  global:
    - secure: cvMQMA2Tfxn3tmDWP7wkll6eIWJ8hNy6hxluLjXV7DrPlLdEZucG3A3PJsjmSaRQk96LWBrUB3qLw35N4ABDjGIjrW8gtkRi1V7PnyKi8gvzyRs1/5VE9u2tYDUrWigI6iACwi8Go8jZgJHG2inbwSg73BtGJnU18NlJPr0tACdJJy6DE3H2MWZPEOBaDwHKtk9DZ49fSfwem1qWGp90U8yqKaRHAmAIXFrE9bL1pTkt+NT51c6CxCE5oUBMDrVbGFJB45IbD9+0gpmwNKEkY/Jn0H5lW/+SjSJAni/c1UKXDEbj+qOf50o6osbwbqIo3lKAlUYcoCJRw3MfjuUBGX2q5Y1dXFN+lDK0XGiJC3UIvli6xwfZ4wB0YXZ3Qmt5AdOU1UaWoM9GYRWqWSTzoIu7THVpbGL2g5k7njN3VrNj7kXYkT4x8lCY4pjniRrj8drbis7uQ69KZc6jKxv8nsNPDriVTQqJpPLtow4zUGtSRKhMrR4P3DNORRbGaq95BvjhU71iVeiS/npHex99W+J4YKRPv6kcNTGKtXcI95Dv/My5bPIW34msFdh9dfpayEKOAVKpSelwZ5SAJGJS1/W2Sh/DYTBs/4gTP+zO1e7FQeTrt3hsDSbMn9oGpK8KrmOtJyH9/Cc6+LUiXoDNZ3u6gFKGa1kvcwVT/SOiOx8=
    - secure: 4x4vCbOnrO2pCQNnZSSw9SjxUpShtxdOuhqgXf3446r8zlVPlU/15aXjtzdxRxiXu3FZBh/S6LjVdzn/bziuIWcdcmOAp34FUQoFBWwAlFEb/gZJNZHdn65s8huRwWHatvj3VUn6CRIHV7XhEifX0hnhRzFpVzT/wHdo4todbgsN1i/qZw4LrtsGHF0+40QzQVR0ZZFvg07VJAQxGLh+OeAla+Luhv4Fqyk5Hv1dwhYRhUXKDMe58uc2UCe8094CqTOsdlPHTRQ0ngoy3wSMSnXR/pL+nch6R4p+VwEv47F5Up54Q1p4SeziLi4T1SHt2qk8uQvcKKBXxvmYZ1S6CnIiEk6WCAStUi650xE48MCHyGAo5P9W21IJYGqM29KMsMDAOshn2cFiRWCKP/Sd6oLqqivFEyx5Xv1eeWYmgize+yFQoDPN9NCBowvp/mR7Qe/jA33L53UKJOT/PXxOTK9It0cfSbi5W81ovubCt2aOgnOlI0cWy6MSO/Qasg4yBv8/AzVAhNcuQIkYDHdXCqn2jeqwQD55GUZNEoOp6jN1VErfxnUjl8G8cxZ6hFQ3hEhQCabASHORanCOrQBdRS1itMitYNBYrZK1Vwb7nk9cgoqfZodNFCYjDn2T23O/CIQdMWRPvAJdRx2arAkulV4NJvHpdSHg/75nOq3EZgc=
